---
title: "Distributions: Discrete and Continuous"
author: " Your Name and id"
output:
  html_document:
    number_sections: yes    
    toc: yes
  pdf_document:
    toc: yes
---

This project will help us visualize various functions attacted to the different distributions learnt in class.

# Binomial distribution.

## Probability Mass Function
We will plot the probability mass function for the binomial distribution Bin(n, p).
Note: 
1) The values for this random variable are 0, 1, 2, ..., n.
2) The density plot will have a bar of height P(X=k), at the point 'k' on the x-axis. 
3) In the plot include a vertical line at the expected value of Bin(n,p). 

Write a function plot_binom, that takes input values: n and p, and returns the density plot of Bin(n,p). 


```{r}
# plot_binom_pmf <- function(n,p){
#   
# }
```
Fix n = 40. Compute plots of the pmf for the following values of p: 0.05, 0.1, 0.4, 0.6, 0.9, 0.95. Have all the plots on the same frame.  

```{r}

```

What do you notice about the shape of the plots? Consider skewness and symmetry.
YOUR ANSWER: 

## Cumulative Distribution Functions
Write a function to plot the cumulative distribution function of the Binomial random variable, call it 'plot_binom_cdf'.
```{r}
#plot_binom_pmf <- function(n=2, p=0.5){
# x <- 0:n
#  binomvals <- dbinom( )
#  plot(x, pois, type = "h", lwd = 5,
#       main = paste("Poisson density: mu = ", mu),
#       xlab = "x", ylab = "P(X=x)")
#  abline(v = mu_X, col = 'red', lwd = 4)
#}

```
Fix n = 40. Compute plots of the of the graphs cdf for the following values of p: 0.05, 0.1, 0.4, 0.6, 0.9, 0.95. Have all graphs on the same plot (with different colors).
Draw a horizontal line at $y=0.8$.
```{r}
x <- seq(-10, 20, length.out = 1000)
#plot(x, pbinom(x, size = 15, prob = 0.8))

par(mfrow = c(2,1))
plot(x, pbinom(x, size = 15, prob = 0.99),
     main = "CDF of Binomial with p = 0.99",
     xlab = "x_values",
     ylab = "cdf of Binnomial")
plot(x, pbinom(x, size = 15, prob = 0.6))
plot(x, pbinom(x, size = 15, prob = 0.4))
plot(x, pbinom(x, size = 15, prob = 0.05))
```
Interpret the values of $x$ where the line $y=0.8$ intersects the graphs of the different cdf.
YOUR ANSWER:

# Poisson Distribution.
## Probability Mass Functions
We will plot the mass function for the Poison distribution Pois(mu).
Note: 
1) The values for this random variable are: 0, 1, 2, 3, .... 
2) The density plot will have a bar of height P(X=k), at the point 'k' on the x-axis.
3) Since most of the densities will be concentrated at lower values of k, we will fix a large enough value of n, say n = 100, when drawing the density plots. 
3) In the plot include a vertical line at the expected value of Pois(mu). 

Write a function plot_pois, that takes input values: mu, and returns the density plot of Pois(mu).

```{r}
n <- 100 
plot_pois_pmf <- function(mu){
  x <- 0:n
  pois <- dpois(x, lambda = mu)
  mu_X <- mu
  plot(x, pois, type = "h", lwd = 5,
       main = paste("Poisson density: mu = ", mu),
       xlab = "x", ylab = "P(X=x)")
  abline(v = mu_X, col = 'red', lwd = 4)
}

plot_pois_pmf(5)
```

For the following values of mu compute the plots for the pmf of the Poisson distribution:
mu: 0.5, 1, 5, 8, 20, 50. Have all plots on the same frame. 

```{r}

```

## Cumulative Distribution Functions
Write a function 'plot_pois_cdf' that takes input $\mu$ and returns the plot of the cdf of the $\text{Pois}(\mu)$. 
```{r}

```
For the following values of mu compute the plots for the pmf of the Poisson distribution:
mu: 0.5, 1, 5, 8, 20, 50. Have all plots on the same frame. 

# Comparing Poison with Binomial
We say two random variables $X$ and $Y$ are identically distributed if they have the same cumulative distribution functions, that is 
$$ F_X(u) = F_Y(u) \quad \quad \forall x\in \mathbb{R}$$
In class we noted the Poisson approximation of the Binomial distribution. Let's visualize it now:

Plot the graphs of the cdf of $\text{Binom}(n=10, p=0.5)$ and $\text{Pois}(\mu= 5)$ on the same plot. 
```{r}

```
Do the graphs overlap? Why/Why not?
YOUR ANSWER: 

Now plot the graphs of the cdf of $\text{Binom}(n= 1000, p= 0.005)$ and $\text{Pois}(\mu= 5)$.

```{r}

```
Do the graphs overlap? Why/Why not?
YOUR ANSWER: 


# Normal Distibution
In this section we will explore the normal distribution. 

## Fixed mean, varying standard deviation
### Plotting Densities
Set $\mu = 5$. For values of $\sigma$ given by $0.2, 0.4, 0.8, 1, 1.3, 1.8, 2$, plot the densities of $N(\mu, \sigma)$ in the same plot. It might help if (1) you have the densities of $N(\mu = 5, \sigma = 0.2)$ and $N(\mu = 5, \sigma = 2)$ to be blue in color and the rest to be red. (2) choose appropriate limits for the x-axis (use x_lim parameter in the plot funtion) and y-axis (use y_lim). 


Method 1: Using 'plot' function from R-base
```{r}
mu <- 5
sds <- c(0.4, 0.8, 1, 1.3, 1.8, 2)

x <- seq(-6, 6, length.out = 1000)
x <- 5+x
y <- dnorm(x, mean = 5, sd=0.2)

plot(x, y, 
     type = 'l',
     main= "Plot of Normal Density with mean 5")
abline(v=5, h=0)
for(std in sds){
  y_temp <- dnorm(x, mean = 5, sd=std)
  lines(x, y_temp,
        type = 'l',
        col = 'red')
}
```

Method 2: Using ggplot
```{r}
library(tidyverse)
```

```{r}
x <- seq(-6, 6, length.out = 1000)
x <- 5+x
```

```{r}
y_0.2 <- dnorm(x, mean= 5, sd = 0.2)
y_0.4 <- dnorm(x, mean= 5, sd = 0.4)
y_0.8 <- dnorm(x, mean= 5, sd = 0.8)
y_1 <- dnorm(x, mean= 5, sd = 1)
y_1.3 <- dnorm(x, mean= 5, sd = 1.3)
y_1.8 <- dnorm(x, mean = 5, sd = 1.8)
y_2 <- dnorm(x, mean= 5, sd = 2)

plot_data_pdf <- data.frame(x,y_0.2,y_0.4,y_0.8,y_1,y_1.3, y_1.8, y_2)
```

```{r}
plot_data_pdf_new <- pivot_longer(plot_data_pdf,
                                  cols = c(y_0.2,y_0.4,y_0.8,y_1,y_1.3, y_1.8, y_2),
                                  names_to = "std_devs"
                                  )
```

```{r}
ggplot(data = plot_data_pdf_new,
  aes(x = x, 
      y = value, 
      group = std_devs,
      color = std_devs))+
  geom_line()+
  labs(title = "Normal Density Plots: Varying Std Devs",
       subtitle = "Jonathan Fernandes",
       x = "x-axis", 
       y = "density")

```


What do you notice about the plot? Comment about how the width changes.

### Plotting Cummulative Distribution Functions
Set $\mu = 5$. For values of $\sigma$ given by $0.2, 0.4, 0.8, 1, 1.3, 1.8, 2$, plot the cummulative distribution function of $N(\mu, \sigma)$ in the same plot.
It might help if (1) you have the cdf of $N(\mu = 5, \sigma = 0.2)$ and $N(\mu = 5, \sigma = 2)$ to be blue in color and the rest to be red. (2) choose appropriate limits for the x-axis (use x_lim parameter in the plot funtion) and y-axis (use y_lim).
```{r}
z_0.2 <- pnorm(x, mean= 5, sd = 0.2)
z_0.4 <- pnorm(x, mean= 5, sd = 0.4)
z_0.8 <- pnorm(x, mean= 5, sd = 0.8)
z_1 <- pnorm(x, mean= 5, sd = 1)
z_1.3 <- pnorm(x, mean= 5, sd = 1.3)
z_1.8 <- pnorm(x, mean = 5, sd = 1.8)
z_2 <- pnorm(x, mean= 5, sd = 2)

plot_data_cdf <- data.frame(x,z_0.2,z_0.4,z_0.8,z_1,z_1.3, z_1.8, z_2)
```

```{r}
plot_data_cdf_new <- pivot_longer(plot_data_cdf,
                                  cols = c(z_0.2,z_0.4,z_0.8,z_1,z_1.3, z_1.8, z_2),
                                  names_to = "std_devs"
                                  )
```

```{r}
ggplot(data = plot_data_cdf_new,
  aes(x = x, 
      y = value, 
      group = std_devs,
      color = std_devs))+
  geom_line()+
  labs(title = "Normal Density Plots: Varying Std Devs",
       subtitle = "Jonathan Fernandes",
       x = "x-axis", 
       y = "density")

```


What information does the point of intersection of two cdfs give us?

## Varying mean, fixed standard deviation
### Plotting Densities 
Set $\sigma = 0.4$. For values of $\mu$ given by $-1, -0.5, 0, 0.4, 0.9, 2.5, 4$ plot the densities of $N(\mu, \sigma)$ in the same plot. You might need to choose appropriate limits for the x-axis.
```{r}

```

### Plotting Cummulative Distribution Functions
Set $\sigma = 0.4$. For values of $\mu$ given by $-1, -0.5, 0, 0.4, 0.9, 2.5, 4$ plot the cumulative distribution functions of $N(\mu, \sigma)$ in the same plot. You might need to choose appropriate limits for the x-axis.
```{r}

```

# Exponential Distribution
## Probablity Density Function 
For values of $\lambda$ in $(0.2, 0.5, 1, 2, 8, 10)$ plot the graphs of the densities of $\text{Exp}(\lambda)$ in the same plot.
```{r}

```

## Cummulative Distribution Function
For values of $\lambda$ in $(0.2, 0.5, 1, 2, 8, 10)$ plot the graphs of the cumulative distribution function of $\text{Exp}(\lambda)$ in the same plot. Draw a horizontal line at $y=0.8$.
```{r}

```

Interpret the values of $x$ where the line $y=0.8$ intersects with the graphs of the cdfs. 
YOUR ANSWER:

# Gamma Distibution
We will plot the Gamma distribution for different shapes and scales. You might need to adjust the limits of x and y axes appropriately.

## Different Shapes
For values of $\alpha \in (0.3,0.7, 1, 1.5, 2, 2.5, 10)$, plot the Plot the densities of $\text{Gamma}(\alpha, \beta = 1)$ in a single plot. 


```{r}
x <- seq(0, 10, length.out = 1000)
```

```{r}
y_0.3 <- dgamma(x, shape = 0.3, scale = 1)
y_0.7 <- dgamma(x, shape = 0.7, scale = 1)
y_1 <- dgamma(x, shape = 1, scale = 1)
y_1.5 <- dgamma(x, shape = 1.5, scale = 1)
y_2 <- dgamma(x, shape = 2, scale = 1)
y_2.5 <- dgamma(x, shape = 2.5, scale = 1)
#y_10 <- dgamma(x, shape = 10, scale = 1)

plot_data_pdf <- data.frame(x,y_1,y_1.5,y_2, y_2.5)
```

```{r}
plot_data_pdf_new <- pivot_longer(plot_data_pdf,
                                  cols = c(y_1,y_1.5,y_2, y_2.5),
                                  names_to = "shapes"
                                  )
```

```{r}
ggplot(data = plot_data_pdf_new,
  aes(x = x, 
      y = value, 
      group = shapes,
      color = shapes))+
  geom_line()+
  labs(title = "Gamma Density Plots: Varying Shapes",
       subtitle = "Jonathan Fernandes",
       x = "x-axis", 
       y = "density")

```
For each of the shapes, identify a feature that distinguishes one shape from the other. This to consider a: does it have a peak, concavity, presence of inflection points, ect.
YOUR RESPONSE:


## $\alpha =1$ , varying scales
Set $\alpha = 1$, vary $\beta$ over $0.2, 0.6, 1, 1.5, 2$. Plot the densities of $\text{Gamma}(\alpha, \beta)$ in a single plot.

```{r}

```

## $\alpha =0.6$ , varying scales
Set $\alpha = 0.6$, vary $\beta$ over $0.2, 0.6, 1, 1.5, 2$. Plot the densities of $\text{Gamma}(\alpha, \beta)$ in a single plot.

```{r}

```

## $\alpha = 2$ , varying scales
Set $\alpha = 2$, vary $\beta$ over $0.2, 0.6, 1, 1.5, 2$. Plot the densities of $\text{Gamma}(\alpha, \beta)$ in a single plot.
```{r}

```

## $\alpha = 5$ , varying scales
Set $\alpha = 5$, vary $\beta$ over $0.2, 0.6, 1, 1.5, 2$. Plot the densities of $\text{Gamma}(\alpha, \beta)$ in a single plot.
```{r}

```

